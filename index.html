<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Demo funcionamiento DOMParser + XML embebido</title>
  <!-- Estilos básicos sólo de prueba -->
  <style>
    body { font-family: sans-serif; margin: 2rem; }
    .hero { padding: 1rem; background: #def; margin-bottom: 1rem; }
    .gallery { background: #fde; padding: 1rem; margin-bottom: 1rem; }
  </style>
</head>
<body>
  <div class="hero">
    <h1 data-cms="hero.title">Título por defecto</h1>
    <p data-cms="hero.subtitle">Subtítulo por defecto</p>
  </div>

  <div class="gallery">
    <h2 data-cms="gallery.title">Galería por defecto</h2>
    <img data-cms-img="gallery.img1" src="" alt="Imagen 1" width="200">
  </div>

  <!-- Bloque XML embebido (aquí editas) -->
  <script type="application/xml" id="cms-data"><site>
  <hero>
    <title>¡Carga exitosa!</title>
    <subtitle>Este contenido vino del XML embebido.</subtitle>
  </hero>
  <gallery>
    <title>Nuestra galería desde XML</title>
    <img1>https://images.unsplash.com/photo-1503023345310-bd7c1de61c7d?w=260</img1>
  </gallery>
</site></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const xmlText = document.getElementById('cms-data').textContent.trim();
      const doc = new DOMParser().parseFromString(xmlText, 'application/xml');
      const errorNode = doc.querySelector('parsererror');
      if (errorNode) {
        console.error('Error al parsear XML:', errorNode.textContent);
        document.body.insertAdjacentHTML('afterbegin', '<p style="color:red;">Error en XML: revisa la sintaxis.</p>');
        return;
      }
      const mapText = {
        'hero.title': 'site > hero > title',
        'hero.subtitle': 'site > hero > subtitle',
        'gallery.title': 'site > gallery > title'
      };
      document.querySelectorAll('[data-cms]').forEach(el => {
        const key = el.getAttribute('data-cms');
        const sel = mapText[key];
        const node = sel && doc.querySelector(sel);
        if (node) el.textContent = node.textContent.trim();
      });
      const mapImg = {
        'gallery.img1': 'site > gallery > img1'
      };
      document.querySelectorAll('[data-cms-img]').forEach(img => {
        const key = img.getAttribute('data-cms-img');
        const sel = mapImg[key];
        const node = sel && doc.querySelector(sel);
        if (node) img.src = node.textContent.trim();
      });
    });
  </script>
</body>
</html>

